<!DOCTYPE html>
<html>
<head>
    <title>Campanii Video</title>
</head>
<body style="margin:0; background:black; display:flex; align-items:center; justify-content:center; height:100vh;">
    
    <div>
        <button id="nextButton" onclick="skipVideo()" style="position:absolute; top:10px; right:10px; padding:10px; background:gray; color:white; border:none; border-radius:5px; cursor:pointer;">
            Next â–¶
        </button>

        <!-- video id -->
        <h1 id="videoID" style="color:white; position:absolute; top:10px; left:10px;">Video Player</h1>
    </div>

    <div>
        <video id="videoPlayer" width="100%" height="100%" autoplay muted></video>
    </div>

    <script>
    const player = document.getElementById("videoPlayer");
    const videoID = document.getElementById("videoID"); 

    const nextButton = document.getElementById("nextButton");

    async function loadVideo() {
        nextButton.disabled = true;
        const response = await fetch("/next-video");
        const blob = await response.blob();
        const url = URL.createObjectURL(blob);
        player.src = url;
        await player.play();
        updateVideoID();
        nextButton.disabled = false;
    }



    function skipVideo() {
        console.log("Skipping video...");
        loadVideo();
    }


    // Update video ID
    async function updateVideoID() {
        try {
            const response = await fetch("/api/current-video-id");
            const data = await response.json();

            if (data.id) {
                videoID.textContent = `Video ID: ${data.id}`;
            } else {
                videoID.textContent = `Video ID: unknown`;
            }
        } catch (err) {
            videoID.textContent = `Video ID: error`;
            console.error("Failed to fetch video ID:", err);
        }
    }

    player.addEventListener("loadeddata", updateVideoID);
    player.addEventListener("ended", loadVideo);

    loadVideo();
    </script>
</body>
</html>
